(function(t){if(typeof exports==="object"&&typeof module!=="undefined"){module.exports=t()}else if(typeof define==="function"&&define.amd){define([],t)}else{var e;if(typeof window!=="undefined"){e=window}else if(typeof global!=="undefined"){e=global}else if(typeof self!=="undefined"){e=self}else{e=this}e.WavEncoder=t()}})(function(){var t,e,n;return function i(t,e,n){function r(s,a){if(!e[s]){if(!t[s]){var f=typeof require=="function"&&require;if(!a&&f)return f(s,!0);if(o)return o(s,!0);var u=new Error("Cannot find module '"+s+"'");throw u.code="MODULE_NOT_FOUND",u}var c=e[s]={exports:{}};t[s][0].call(c.exports,function(e){var n=t[s][1][e];return r(n?n:e)},c,c.exports,i,t,e,n)}return e[s].exports}var o=typeof require=="function"&&require;for(var s=0;s<n.length;s++)r(n[s]);return r}({1:[function(t,e,n){"use strict";var self={};function i(){self.onmessage=function(t){switch(t.data.type){case"encode":self.encode(t.data.audioData,t.data.format).then(function(t){self.postMessage({type:"encoded",buffer:t},[t])})["catch"](function(t){self.postMessage({type:"error",message:t.message})});break}};self.encode=function(e,n){n.floatingPoint=!!n.floatingPoint;n.bitDepth=n.bitDepth|0||16;return new Promise(function(i){var r=e.numberOfChannels;var o=e.sampleRate;var s=n.bitDepth>>3;var a=e.length*r*s;var f=new t(44+a);f.writeString("RIFF");f.writeUint32(f.length-8);f.writeString("WAVE");f.writeString("fmt ");f.writeUint32(16);f.writeUint16(n.floatingPoint?3:1);f.writeUint16(r);f.writeUint32(o);f.writeUint32(o*r*s);f.writeUint16(r*s);f.writeUint16(n.bitDepth);f.writeString("data");f.writeUint32(a);var u=e.buffers.map(function(t){return new Float32Array(t)});f.writePCM(u,n);i(f.toArrayBuffer())})};function t(t){this.buffer=new ArrayBuffer(t);this.view=new DataView(this.buffer);this.length=t;this.pos=0}t.prototype.writeUint8=function(t){this.view.setUint8(this.pos,t);this.pos+=1};t.prototype.writeUint16=function(t){this.view.setUint16(this.pos,t,true);this.pos+=2};t.prototype.writeUint32=function(t){this.view.setUint32(this.pos,t,true);this.pos+=4};t.prototype.writeString=function(t){for(var e=0;e<t.length;e++){this.writeUint8(t.charCodeAt(e))}};t.prototype.writePCM8=function(t){t=Math.max(-128,Math.min(t*128,127))|0;this.view.setInt8(this.pos,t);this.pos+=1};t.prototype.writePCM16=function(t){t=Math.max(-32768,Math.min(t*32768,32767))|0;this.view.setInt16(this.pos,t,true);this.pos+=2};t.prototype.writePCM24=function(t){t=Math.max(-8388608,Math.min(t*8388608,8388607))|0;this.view.setUint8(this.pos+0,t>>0&255);this.view.setUint8(this.pos+1,t>>8&255);this.view.setUint8(this.pos+2,t>>16&255);this.pos+=3};t.prototype.writePCM32=function(t){t=Math.max(-2147483648,Math.min(t*2147483648,2147483647))|0;this.view.setInt32(this.pos,t,true);this.pos+=4};t.prototype.writePCM32F=function(t){this.view.setFloat32(this.pos,t,true);this.pos+=4};t.prototype.writePCM64F=function(t){this.view.setFloat64(this.pos,t,true);this.pos+=8};t.prototype.writePCM=function(t,e){var n=t[0].length;var i=t.length;var r="writePCM"+e.bitDepth;if(e.floatingPoint){r+="F"}if(!this[r]){throw new Error("not suppoerted bit depth "+e.bitDepth)}for(var o=0;o<n;o++){for(var s=0;s<i;s++){this[r](t[s][o])}}};t.prototype.toArrayBuffer=function(){return this.buffer};self.BufferWriter=t}i.self=i.util=self;e.exports=i},{}],2:[function(t,e,n){"use strict";var i=function(t){return t&&t.__esModule?t["default"]:t};var r=function(){function t(t,e){for(var n in e){var i=e[n];i.configurable=true;if(i.value)i.writable=true}Object.defineProperties(t,e)}return function(e,n,i){if(n)t(e.prototype,n);if(i)t(e,i);return e}}();var o=function(t,e){if(!(t instanceof e)){throw new TypeError("Cannot call a class as a function")}};"use stirct";var s=i(t("inline-worker"));var a=i(t("./encoder-worker"));var f=function(){function t(){o(this,t)}r(t,{encode:{value:function e(t){var e=arguments[1]===undefined?{}:arguments[1];return new Promise(function(n){var i=new s(a,a.self);i.onmessage=function(t){if(t.data.type==="encoded"){n(t.data.buffer)}};var r=t.channelData.length;var o=t.channelData[0].length;var f=t.sampleRate;var u=t.channelData.map(function(t){return t.buffer});var c={numberOfChannels:r,length:o,sampleRate:f,buffers:u};i.postMessage({type:"encode",audioData:c,format:e},c.buffers)})}}});return t}();e.exports=f},{"./encoder-worker":1,"inline-worker":4}],3:[function(t,e,n){"use strict";var i=function(t){return t&&t.__esModule?t["default"]:t};var r=i(t("./encoder"));e.exports=r},{"./encoder":2}],4:[function(t,e,n){"use strict";e.exports=t("./inline-worker")},{"./inline-worker":5}],5:[function(t,e,n){(function(t){"use strict";var n=function(){function t(t,e){for(var n in e){var i=e[n];i.configurable=true;if(i.value)i.writable=true}Object.defineProperties(t,e)}return function(e,n,i){if(n)t(e.prototype,n);if(i)t(e,i);return e}}();var i=function(t,e){if(!(t instanceof e)){throw new TypeError("Cannot call a class as a function")}};var r=!!(t===t.window&&t.URL&&t.Blob&&t.Worker);var o=function(){function e(n,self){var o=this;i(this,e);if(r){var s=n.toString().trim().match(/^function\s*\w*\s*\([\w\s,]*\)\s*{([\w\W]*?)}$/)[1];var a=t.URL.createObjectURL(new t.Blob([s],{type:"text/javascript"}));return new t.Worker(a)}this.self=self;this.self.postMessage=function(t){setTimeout(function(){o.onmessage({data:t})},0)};setTimeout(function(){n.call(self)},0)}n(e,{postMessage:{value:function o(t){var e=this;setTimeout(function(){e.self.onmessage({data:t})},0)}}});return e}();e.exports=o}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{}]},{},[3])(3)});